type Query {
  task(where: TaskWhereInput): TaskInfo
  tasks(where: TaskWhereInput): [TaskInfo]!
}

type Mutation {
  createTask(input: CreateTaskInput!): TaskInfo!
  startTask(input: StartTaskInput!): StartTaskResult!
}

type TaskInfo {
  id: ID!
  taskInput: String!
  taskStatus: TaskStatus!
  createdAt: String!
}

type StartTaskResult {
  isSuccess: Boolean!
  failedReason: String
}

input CreateTaskInput {
  taskInput: String!
}

input StartTaskInput {
  taskId: ID!
}

# ============================================
# 1. Enum Type Definitions
# ============================================

"""
Task status
"""
enum TaskStatus {
  IDLE
  RUNNING
  COMPLETED
  ABORTED
}

"""
Message sender role
"""
enum MessageRole {
  USER
  ASSISTANT
  SYSTEM
}

# ============================================
# 2. Message Content Type Definitions
# ============================================

"""
API message
"""
type Message {
  """
  Sender role
  """
  role: MessageRole!

  """
  Message text content (null if blocks are present)
  """
  text: String

  """
  Message blocks array (null if text is present)
  """
  blocks: [MessageBlock!]

  """
  Timestamp (milliseconds)
  """
  ts: String
}

"""
Message block
"""
type MessageBlock {
  """
  Block type identifier
  """
  type: String!

  """
  Text content (for text blocks)
  """
  text: String

  """
  Image source (for image blocks)
  """
  imageSource: ImageSource

  """
  Tool use ID (for tool use blocks)
  """
  toolUseId: String

  """
  Tool name (for tool use blocks)
  """
  toolName: String

  """
  Tool input (for tool use blocks)
  """
  toolInput: String

  """
  Tool result tool use ID (for tool result blocks)
  """
  toolResultId: String

  """
  Tool result content (for tool result blocks)
  """
  toolResultContent: String
}

"""
Image resource information
"""
type ImageSource {
  type: String!
  media_type: String!
  data: String!
}

# ============================================
# 3. Input Type Definitions
# ============================================

"""
Generic block input
"""
input BlockInput {
  type: String!
  # Specific fields are dynamically processed based on type
}

"""
Text block input
"""
input TextBlockInput {
  type: String!
  text: String!
}

"""
Image source input
"""
input ImageSourceInput {
  type: String!
  media_type: String!
  data: String!
}

"""
Image block input
"""
input ImageBlockInput {
  type: String!
  source: ImageSourceInput!
}

"""
Tool use block input
"""
input ToolUseBlockInput {
  type: String!
  id: String!
  name: String!
  input: String!
}

"""
Tool result block input
"""
input ToolResultBlockInput {
  type: String!
  tool_use_id: String!
  content: String
}

"""
Message block input union type
"""
input MessageBlockInput {
  type: String!
  text: String
  source: ImageSourceInput
  id: String
  name: String
  input: String
  tool_use_id: String
  content: String
}

input TaskWhereInput {
  """
  Filter by task ID
  """
  id: ID

  """
  Filter by task IDs
  """
  id_in: [ID!]

  """
  Filter by user ID
  """
  userId: String

  """
  Filter by user IDs
  """
  userId_in: [String!]

  """
  Filter by task status
  """
  status: TaskStatus

  """
  Filter by task statuses
  """
  status_in: [TaskStatus!]

  """
  Filter by creation date (greater than)
  """
  createdAt_gt: String

  """
  Filter by creation date (less than)
  """
  createdAt_lt: String

  """
  Filter by creation date (greater than or equal)
  """
  createdAt_gte: String

  """
  Filter by creation date (less than or equal)
  """
  createdAt_lte: String

  """
  Filter by task input (contains)
  """
  taskInput_contains: String

  """
  Filter by task input (starts with)
  """
  taskInput_starts_with: String

  """
  Logical AND - all conditions must be satisfied
  """
  AND: [TaskWhereInput!]

  """
  Logical OR - at least one condition must be satisfied
  """
  OR: [TaskWhereInput!]

  """
  Logical NOT - negates the conditions (all conditions must NOT be satisfied)
  """
  NOT: [TaskWhereInput!]
}
