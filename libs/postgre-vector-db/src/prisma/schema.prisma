generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}


model chunk_embed_groups {
  id               String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  token            String
  item_id          String        @db.Uuid
  name             String        @db.VarChar(255)
  description      String?
  chunking_config  Json
  embedding_config Json
  is_default       Boolean       @default(false)
  is_active        Boolean       @default(true)
  created_at       DateTime      @default(now()) @db.Timestamptz(6)
  updated_at       DateTime      @default(now()) @db.Timestamptz(6)
  created_by       String?       @db.VarChar(255)
  tags             String[]      @default([])
  status           String        @default("WAIT_FOR_CHUNK_EMBED") @db.VarChar(50)
  item_chunks      item_chunks[]

  @@index([item_id])
  @@index([status])
  @@index([is_active])
  @@index([token])
}

model item_chunks {
  id                          String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  item_id                     String             @db.Uuid
  dense_vector_index_group_id String             @db.Uuid
  title                       String             @db.VarChar(500)
  content                     String
  index                       Int
  embedding                   Unsupported("VECTOR")?
  strategy_metadata           Json
  metadata                    Json?
  created_at                  DateTime           @default(now()) @db.Timestamptz(6)
  updated_at                  DateTime           @default(now()) @db.Timestamptz(6)
  chunk_embed_groups          chunk_embed_groups @relation(fields: [dense_vector_index_group_id], references: [id], onDelete: Cascade)

  @@index([item_id])
  @@index([dense_vector_index_group_id])
  @@index([index])
}
